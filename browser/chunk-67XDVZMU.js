import{g as u,o as i,p as U}from"./chunk-YKW7H7HN.js";import{a,b as o}from"./chunk-2NFLSA4Y.js";var h="school-helper-users",c="school-helper-current-user",l="Default",d=class t{users=i([]);currentUser=i(null);constructor(){this.initializeUsers(),U(()=>{let e=this.currentUser();e?localStorage.setItem(c,e):localStorage.removeItem(c)})}initializeUsers(){let e=this.loadUsers(),r=localStorage.getItem(c);if(e.length===0){let s={name:l,createdAt:new Date};this.users.set([s]),this.currentUser.set(l),this.saveUsers()}else{this.users.set(e);let s=r||e[0].name;e.some(n=>n.name===s)?this.currentUser.set(s):this.currentUser.set(e[0].name)}}loadUsers(){try{let e=localStorage.getItem(h);return e?JSON.parse(e).map(s=>o(a({},s),{createdAt:new Date(s.createdAt)})):[]}catch(e){return console.error("Error loading users from localStorage:",e),[]}}saveUsers(){try{let e=this.users().map(r=>o(a({},r),{createdAt:r.createdAt.toISOString()}));localStorage.setItem(h,JSON.stringify(e))}catch(e){console.error("Error saving users to localStorage:",e)}}createUser(e){let r=e.trim();if(!r||this.users().some(n=>n.name===r))return!1;let s={name:r,createdAt:new Date};return this.users.set([...this.users(),s]),this.saveUsers(),!0}switchUser(e){return this.users().some(s=>s.name===e)?(this.currentUser.set(e),!0):!1}deleteUser(e){if(e===l&&this.users().length===1)return!1;let r=this.users().filter(s=>s.name!==e);return r.length===this.users().length?!1:(this.users.set(r),this.saveUsers(),this.currentUser()===e&&this.currentUser.set(r[0].name),!0)}getCurrentUserName(){return this.currentUser()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})};export{d as a};
