import{a as N}from"./chunk-Y2JVOSOJ.js";import{a as V,b as z}from"./chunk-QSHF6WVO.js";import{a as q}from"./chunk-3ICQCNNT.js";import{a as $,b as O,c as j,d as A,e as G,i as R,j as B,m as I,n as L}from"./chunk-RHKKWBP4.js";import{a as T}from"./chunk-67XDVZMU.js";import{$ as D,D as f,E as b,F as _,H as y,I as P,J as C,K as i,L as o,M as x,Q as h,R as m,T as l,Y as k,Z as c,_ as w,j as g,ja as E,k as u,ka as F,l as p,o as U,v as a,y as S}from"./chunk-YKW7H7HN.js";import"./chunk-2NFLSA4Y.js";var J=(r,t)=>t.name;function K(r,t){r&1&&(i(0,"span",15),c(1,"\u2713"),o())}function Q(r,t){if(r&1){let e=h();i(0,"button",17),m("click",function(s){u(e);let d=l().$implicit,v=l(2);return p(v.deleteUser(d.name,s))}),c(1," \u2715 "),o()}if(r&2){let e=l().$implicit;f("aria-label","Delete user "+e.name)}}function X(r,t){if(r&1){let e=h();i(0,"div",7)(1,"button",13),m("click",function(){let s=u(e).$implicit,d=l(2);return p(d.switchUser(s.name))}),i(2,"span",14),c(3),o(),b(4,K,2,0,"span",15),o(),b(5,Q,2,1,"button",16),o()}if(r&2){let e=t.$implicit,n=l(2);a(),k("active",e.name===n.currentUser()),a(2),w(e.name),a(),_(e.name===n.currentUser()?4:-1),a(),_(n.canDeleteUser(e.name)?5:-1)}}function Z(r,t){r&1&&c(0," User name is required ")}function ee(r,t){if(r&1&&(i(0,"div",12),b(1,Z,1,0),o()),r&2){let e,n=l(2);a(),_(!((e=n.newUserForm.get("userName"))==null||e.errors==null)&&e.errors.required?1:-1)}}function te(r,t){if(r&1){let e=h();i(0,"div",5)(1,"div",6),c(2,"Users"),o(),y(3,X,6,5,"div",7,J),x(5,"div",8),i(6,"form",9),m("ngSubmit",function(){u(e);let s=l();return p(s.createUser())}),i(7,"input",10),m("keydown.escape",function(){u(e);let s=l();return p(s.closeDropdown())}),o(),i(8,"button",11),c(9," Create "),o()(),b(10,ee,2,1,"div",12),o()}if(r&2){let e,n=l();a(3),P(n.users()),a(3),C("formGroup",n.newUserForm),a(2),C("disabled",n.newUserForm.invalid),a(2),_((e=n.newUserForm.get("userName"))!=null&&e.invalid&&((e=n.newUserForm.get("userName"))!=null&&e.touched)?10:-1)}}var M=class r{userService=g(T);userProgressService=g(V);settingsService=g(q);fb=g(I);users=this.userService.users;currentUser=this.userService.currentUser;showDropdown=U(!1);newUserForm;constructor(){this.newUserForm=this.fb.group({userName:["",[O.required,O.minLength(1)]]})}toggleDropdown(){this.showDropdown.update(t=>!t)}closeDropdown(){this.showDropdown.set(!1),this.newUserForm.reset()}switchUser(t){this.userService.switchUser(t),this.closeDropdown()}createUser(){if(this.newUserForm.invalid){this.newUserForm.markAllAsTouched();return}let t=this.newUserForm.get("userName")?.value?.trim();if(!t)return;this.userService.createUser(t)?(this.userProgressService.initializeUserProgress(t),this.settingsService.initializeUserSettings(t),this.userService.switchUser(t),this.newUserForm.reset(),this.closeDropdown()):this.newUserForm.get("userName")?.setErrors({duplicate:!0})}canDeleteUser(t){return this.users().length>1}deleteUser(t,e){if(e.stopPropagation(),!this.canDeleteUser(t))return;let n=`Are you sure you want to delete user "${t}"? This will permanently delete all their progress and settings. This action cannot be undone.`;confirm(n)&&(this.userProgressService.deleteUserProgress(t),this.settingsService.deleteUserSettings(t),this.userService.deleteUser(t)||alert(`Cannot delete user "${t}". You must have at least one user.`))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-user-selector"]],decls:9,vars:6,consts:[[1,"user-selector"],["type","button",1,"user-button",3,"click"],[1,"user-icon"],[1,"user-name"],[1,"dropdown-arrow"],["role","menu",1,"dropdown-menu"],[1,"dropdown-header"],[1,"user-option-wrapper"],[1,"divider"],[1,"new-user-form",3,"ngSubmit","formGroup"],["type","text","formControlName","userName","placeholder","New user name","aria-label","New user name",1,"new-user-input",3,"keydown.escape"],["type","submit","aria-label","Create new user",1,"create-button",3,"disabled"],[1,"error-message"],["type","button","role","menuitem",1,"user-option",3,"click"],[1,"user-option-name"],[1,"checkmark"],["type","button","title","Delete user",1,"delete-user-button"],["type","button","title","Delete user",1,"delete-user-button",3,"click"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"button",1),m("click",function(){return n.toggleDropdown()}),i(2,"span",2),c(3,"\u{1F464}"),o(),i(4,"span",3),c(5),o(),i(6,"span",4),c(7,"\u25BC"),o()(),b(8,te,11,3,"div",5),o()),e&2&&(a(),f("aria-expanded",n.showDropdown())("aria-label","Current user: "+n.currentUser()+", click to switch user"),a(4),w(n.currentUser()),a(),k("open",n.showDropdown()),a(2),_(n.showDropdown()?8:-1))},dependencies:[L,G,$,j,A,B,R],styles:[".user-selector[_ngcontent-%COMP%]{position:relative}.user-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:var(--user-button-bg, #f5f5f5);border:2px solid var(--user-button-border, #e0e0e0);border-radius:.5rem;cursor:pointer;font-size:.875rem;font-weight:600;color:var(--text-primary, #333);min-height:44px;transition:all .2s ease}.user-button[_ngcontent-%COMP%]:hover{background:var(--user-button-hover, #e0e0e0);border-color:var(--user-button-hover-border, #ccc)}.user-icon[_ngcontent-%COMP%]{font-size:1.25rem}.user-name[_ngcontent-%COMP%]{flex:1;text-align:left}.dropdown-arrow[_ngcontent-%COMP%]{font-size:.75rem;transition:transform .2s ease}.dropdown-arrow.open[_ngcontent-%COMP%]{transform:rotate(180deg)}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + .5rem);right:0;min-width:200px;background:var(--dropdown-bg, #fff);border:2px solid var(--dropdown-border, #e0e0e0);border-radius:.5rem;box-shadow:0 4px 12px #00000026;z-index:1000;max-height:400px;overflow-y:auto}.dropdown-header[_ngcontent-%COMP%]{padding:.75rem 1rem;font-weight:600;font-size:.875rem;color:var(--text-secondary, #666);border-bottom:1px solid var(--dropdown-border, #e0e0e0)}.user-option-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:0 .5rem}.user-option[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;background:transparent;border:none;text-align:left;cursor:pointer;font-size:.875rem;color:var(--text-primary, #333);transition:background .2s ease;min-height:44px;border-radius:.25rem}.user-option[_ngcontent-%COMP%]:hover{background:var(--user-option-hover, #f5f5f5)}.user-option.active[_ngcontent-%COMP%]{background:var(--user-option-active, #e3f2fd);color:var(--user-option-active-text, #1976d2)}.user-option-name[_ngcontent-%COMP%]{flex:1}.checkmark[_ngcontent-%COMP%]{color:var(--success-color, #4caf50);font-weight:700}.divider[_ngcontent-%COMP%]{height:1px;background:var(--dropdown-border, #e0e0e0);margin:.5rem 0}.new-user-form[_ngcontent-%COMP%]{padding:.75rem 1rem;display:flex;gap:.5rem}.new-user-input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:2px solid var(--input-border, #ccc);border-radius:.25rem;font-size:.875rem;min-height:36px}.new-user-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--input-focus-border, #4caf50)}.create-button[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--button-primary-bg, #4caf50);color:var(--button-primary-text, #fff);border:none;border-radius:.25rem;font-size:.875rem;font-weight:600;cursor:pointer;min-height:36px;transition:background .2s ease}.create-button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--button-primary-hover, #45a049)}.create-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.delete-user-button[_ngcontent-%COMP%]{width:28px;height:28px;border:none;background:var(--delete-bg, #f44336);color:#fff;border-radius:50%;cursor:pointer;font-size:.875rem;display:flex;align-items:center;justify-content:center;line-height:1;transition:all .2s ease;flex-shrink:0}.delete-user-button[_ngcontent-%COMP%]:hover{background:var(--delete-hover, #d32f2f);transform:scale(1.1)}.delete-user-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.error-message[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.75rem;color:var(--error-color, #f44336)}@media(prefers-color-scheme:dark){.user-selector[_ngcontent-%COMP%]{--user-button-bg: #2a2a2a;--user-button-border: #444;--user-button-hover: #333;--user-button-hover-border: #555;--text-primary: #fff;--text-secondary: #aaa;--dropdown-bg: #2a2a2a;--dropdown-border: #444;--user-option-hover: #333;--user-option-active: #1e3a5f;--user-option-active-text: #64b5f6;--input-border: #555;--input-focus-border: #4caf50;--button-primary-bg: #4caf50;--button-primary-hover: #45a049;--button-primary-text: #fff;--success-color: #4caf50;--error-color: #f44336;--delete-bg: #f44336;--delete-hover: #d32f2f}}"],changeDetection:0})};var ne=(r,t)=>t.id;function re(r,t){r&1&&(i(0,"p",8),c(1,"No math sets available. Create one to get started!"),o())}function oe(r,t){if(r&1){let e=h();i(0,"div",9)(1,"button",10),m("click",function(){let s=u(e).$implicit,d=l(2);return p(d.selectSet(s.id))}),i(2,"div",11)(3,"h2",12),c(4),o(),i(5,"span",13),c(6),o()(),x(7,"app-progress-indicator",14),o(),i(8,"div",15)(9,"button",16),m("click",function(s){let d=u(e).$implicit,v=l(2);return p(v.resetProgress(d.id,s))}),c(10," \u21BB "),o(),i(11,"button",17),m("click",function(s){let d=u(e).$implicit,v=l(2);return p(v.editSet(d.id,s))}),c(12," \u270E "),o(),i(13,"button",18),m("click",function(s){let d=u(e).$implicit,v=l(2);return p(v.deleteSet(d.id,s))}),c(14," \u2715 "),o()()()}if(r&2){let e=t.$implicit,n=l(2);a(),f("aria-label","Select "+e.name),a(3),w(e.name),a(2),D("",e.cards.length," cards"),a(),C("cards",n.getCardsWithProgress(e)),a(2),f("aria-label","Reset progress for "+e.name),a(2),f("aria-label","Edit "+e.name),a(2),f("aria-label","Delete "+e.name)}}function ie(r,t){if(r&1&&y(0,oe,15,7,"div",9,ne),r&2){let e=l();P(e.availableSets())}}var W=class r{mathStateService=g(z);router=g(E);availableSets=this.mathStateService.availableSets;getCardsWithProgress(t){return this.mathStateService.getCardsWithProgress(t)}selectSet(t){this.mathStateService.setCurrentSet(t),this.router.navigate(["/math/exercise",t])}editSet(t,e){e.stopPropagation(),this.router.navigate(["/math/edit",t])}deleteSet(t,e){e.stopPropagation();let n=this.availableSets().find(s=>s.id===t);n&&confirm(`Are you sure you want to delete "${n.name}"? This action cannot be undone.`)&&this.mathStateService.deleteSet(t)}resetProgress(t,e){e.stopPropagation();let n=this.availableSets().find(s=>s.id===t);n&&confirm(`Are you sure you want to reset all progress for "${n.name}"? This will clear all statistics and weights for this set.`)&&this.mathStateService.resetSetProgress(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-set-selection"]],decls:16,vars:1,consts:[[1,"set-selection"],[1,"header"],[1,"header-top"],[1,"subtitle"],[1,"nav"],["routerLink","/math/create",1,"nav-link"],["routerLink","/math/settings",1,"nav-link"],[1,"sets-container"],[1,"empty-state"],[1,"set-card-wrapper"],["type","button",1,"set-card",3,"click"],[1,"set-card-header"],[1,"set-name"],[1,"set-count"],[3,"cards"],[1,"set-actions"],["type","button","title","Reset progress",1,"reset-button",3,"click"],["type","button","title","Edit set",1,"edit-button",3,"click"],["type","button","title","Delete set",1,"delete-button",3,"click"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1"),c(4,"Math Practice"),o(),x(5,"app-user-selector"),o(),i(6,"p",3),c(7,"Select a set to practice"),o()(),i(8,"nav",4)(9,"a",5),c(10,"Create New Set"),o(),i(11,"a",6),c(12,"Settings"),o()(),i(13,"div",7),b(14,re,2,0,"p",8)(15,ie,2,0),o()()),e&2&&(a(14),_(n.availableSets().length===0?14:15))},dependencies:[F,N,M],styles:[".set-selection[_ngcontent-%COMP%]{min-height:100vh;padding:1rem;background:var(--bg-primary, #fff);color:var(--text-primary, #333)}.header[_ngcontent-%COMP%]{margin-bottom:2rem}.header-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;gap:1rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:clamp(2rem,5vw,3rem);margin:0;color:var(--text-primary, #333)}.subtitle[_ngcontent-%COMP%]{font-size:clamp(1rem,2.5vw,1.25rem);color:var(--text-secondary, #666);margin:0}.nav[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center;margin-bottom:2rem;flex-wrap:wrap}.nav-link[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--button-bg, #4caf50);color:var(--button-text, #fff);text-decoration:none;border-radius:.5rem;font-weight:600;transition:background .2s ease;min-height:44px;display:inline-flex;align-items:center}.nav-link[_ngcontent-%COMP%]:hover{background:var(--button-hover, #45a049)}.sets-container[_ngcontent-%COMP%]{display:grid;gap:1rem;max-width:600px;margin:0 auto}.set-card-wrapper[_ngcontent-%COMP%]{position:relative}.set-card[_ngcontent-%COMP%]{width:100%;padding:1.5rem;background:var(--card-bg, #f9f9f9);border:2px solid var(--card-border, #e0e0e0);border-radius:.75rem;text-align:left;cursor:pointer;transition:all .2s ease;min-height:44px}.set-card[_ngcontent-%COMP%]:hover{border-color:var(--card-hover-border, #4caf50);transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.set-card[_ngcontent-%COMP%]:active{transform:translateY(0)}.set-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.set-name[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,1.5rem);margin:0;color:var(--text-primary, #333)}.set-count[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary, #666);background:var(--badge-bg, #e0e0e0);padding:.25rem .75rem;border-radius:1rem}.set-card-progress[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.875rem}.progress-label[_ngcontent-%COMP%]{color:var(--text-secondary, #666)}.progress-value[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary, #333)}.set-actions[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;display:flex;gap:.5rem;z-index:10}.reset-button[_ngcontent-%COMP%], .edit-button[_ngcontent-%COMP%], .delete-button[_ngcontent-%COMP%]{width:32px;height:32px;border:none;color:#fff;border-radius:50%;cursor:pointer;font-size:1.25rem;display:flex;align-items:center;justify-content:center;line-height:1;transition:all .2s ease}.reset-button[_ngcontent-%COMP%]{background:var(--reset-bg, #ff9800)}.reset-button[_ngcontent-%COMP%]:hover{background:var(--reset-hover, #f57c00);transform:scale(1.1)}.reset-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.edit-button[_ngcontent-%COMP%]{background:var(--edit-bg, #2196f3)}.edit-button[_ngcontent-%COMP%]:hover{background:var(--edit-hover, #1976d2);transform:scale(1.1)}.edit-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.delete-button[_ngcontent-%COMP%]{background:var(--delete-bg, #f44336)}.delete-button[_ngcontent-%COMP%]:hover{background:var(--delete-hover, #d32f2f);transform:scale(1.1)}.delete-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;color:var(--text-secondary, #666);font-size:1.125rem}@media(prefers-color-scheme:dark){.set-selection[_ngcontent-%COMP%]{--bg-primary: #1a1a1a;--text-primary: #fff;--text-secondary: #aaa;--card-bg: #2a2a2a;--card-border: #444;--card-hover-border: #4caf50;--button-bg: #4caf50;--button-hover: #45a049;--button-text: #fff;--badge-bg: #444;--edit-bg: #2196f3;--edit-hover: #1976d2;--delete-bg: #f44336;--delete-hover: #d32f2f;--reset-bg: #ff9800;--reset-hover: #f57c00}}"],changeDetection:0})};export{W as SetSelectionComponent};
