import{a as g}from"./chunk-67XDVZMU.js";import{g as n,j as a,o as h,p as d}from"./chunk-YKW7H7HN.js";var M="school-helper-user-",u="-settings",s=3e3,c=1e3,l=1e4,S=class o{userService=a(g);speedThresholdMs=h(s);constructor(){d(()=>{let e=this.userService.currentUser();e&&this.loadFromLocalStorage(e)})}loadFromLocalStorage(e){try{let t=this.getStorageKey(e),r=localStorage.getItem(t);if(r){let i=JSON.parse(r),p=this.validateSpeedThreshold(i.speedThresholdMs);this.speedThresholdMs.set(p)}else this.speedThresholdMs.set(s)}catch(t){console.error(`Error loading math settings for user ${e}:`,t),this.speedThresholdMs.set(s)}}saveSettings(e){let t=this.userService.getCurrentUserName();if(t)try{let r={speedThresholdMs:this.validateSpeedThreshold(e.speedThresholdMs)},i=this.getStorageKey(t);localStorage.setItem(i,JSON.stringify(r)),this.speedThresholdMs.set(r.speedThresholdMs)}catch(r){console.error("Error saving math settings to localStorage:",r)}}getStorageKey(e){return`${M}${e}${u}`}initializeUserSettings(e){let t={speedThresholdMs:s},r=this.getStorageKey(e);localStorage.setItem(r,JSON.stringify(t))}deleteUserSettings(e){try{let t=this.getStorageKey(e);localStorage.removeItem(t)}catch(t){console.error(`Error deleting settings for user ${e}:`,t)}}validateSpeedThreshold(e){return typeof e!="number"||isNaN(e)?s:Math.max(c,Math.min(l,e))}getSettings(){return{speedThresholdMs:this.speedThresholdMs()}}getMinSpeedThreshold(){return c}getMaxSpeedThreshold(){return l}static \u0275fac=function(t){return new(t||o)};static \u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})};export{S as a};
